--- wpa_supplicant-2.10/src/utils/os_unix.c	2022-01-16 12:51:29.000000000 -0800
+++ wpa_supplicant-2.10/src/utils/os_unix.c.1	2023-07-07 15:11:08.739850225 -0700
@@ -804,13 +804,6 @@
 	pid_t pid;
 	int pid_status;
 
-	pid = fork();
-	if (pid < 0) {
-		perror("fork");
-		return -1;
-	}
-
-	if (pid == 0) {
 		/* run the external command in the child process */
 		const int MAX_ARG = 30;
 		char *_program, *_arg, *pos;
@@ -836,6 +829,13 @@
 		}
 		argv[i] = NULL;
 
+	pid = vfork();
+	if (pid < 0) {
+		perror("fork");
+		return -1;
+	}
+
+	if (pid == 0) {
 		execv(program, argv);
 		perror("execv");
 		os_free(_program);
